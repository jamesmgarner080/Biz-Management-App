{'role': 'assistant', 'content': '<function_calls>\n<str-replace file_path="backend/routes/tasks.js">\n<old_str>    // Update task (management only)\n    router.put(\'/:id\', authenticateToken, requireManagement, (req, res) => {\n        try {\n            const { id } = req.params;</old_str>\n<new_str>    // Update task (management only or with permission)\n    router.put(\'/:id\', authenticateToken, (req, res) => {\n        const db = req.app.get(\'db\');\n        \n        // Check if user has permission\n        if (![\'admin\', \'manager\', \'supervisor\'].includes(req.user.role) && \n            !db.hasPermission(req.user.id, \'edit_tasks\')) {\n            return res.status(403).json({ error: \'Permission required: edit_tasks\' });\n        }\n        \n        try {\n            const { id } = req.params;</new_str>\n</str-replace>\n</function_calls>'}